<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Mini réseau social gamer</title>
<style>
  body {
    background: #121212;
    color: #eee;
    font-family: Arial, sans-serif;
    max-width: 600px;
    margin: 30px auto;
    padding: 0 15px;
  }
  h1 {
    text-align: center;
    color: #ff5722;
    margin-bottom: 20px;
  }
  #post-form {
    display: flex;
    flex-direction: column;
    margin-bottom: 25px;
    background: #1e1e1e;
    padding: 15px;
    border-radius: 8px;
  }
  #post-form input, #post-form textarea {
    background: #2a2a2a;
    border: none;
    color: #eee;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 5px;
    font-size: 14px;
    resize: vertical;
  }
  #post-form button {
    background: #ff5722;
    color: white;
    border: none;
    padding: 12px;
    font-weight: bold;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
    transition: background 0.3s;
  }
  #post-form button:hover {
    background: #e64a19;
  }
  .post {
    background: #1e1e1e;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 15px;
    box-shadow: 0 0 6px #ff5722aa;
  }
  .post-header {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
  }
  .avatar {
    width: 40px;
    height: 40px;
    background: #555;
    border-radius: 50%;
    margin-right: 12px;
    flex-shrink: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    font-weight: bold;
    font-size: 18px;
    user-select: none;
  }
  .username {
    font-weight: bold;
    color: #ff5722;
  }
  .content {
    white-space: pre-wrap;
    margin-top: 5px;
    font-size: 15px;
  }
  button.like-btn {
    background: transparent;
    border: none;
    color: #888;
    cursor: pointer;
    margin-top: 10px;
    font-size: 16px;
    user-select: none;
  }
  button.like-btn.liked {
    color: #ff5722;
    font-weight: bold;
  }
  .no-posts {
    text-align: center;
    margin-top: 40px;
    color: #666;
  }
</style>
</head>
<body>
<h1>Mini réseau social gamer</h1>

<form id="post-form">
  <input type="text" id="username" placeholder="Ton pseudo" maxlength="15" required />
  <textarea id="post-content" placeholder="Quoi de neuf ? (max 280 caractères)" maxlength="280" rows="3" required></textarea>
  <button type="submit">Poster</button>
</form>

<div id="posts-container">
  <p class="no-posts">Aucun post pour l'instant. Sois le premier !</p>
</div>

<script>
  const postForm = document.getElementById('post-form');
  const usernameInput = document.getElementById('username');
  const contentInput = document.getElementById('post-content');
  const postsContainer = document.getElementById('posts-container');
  const noPostsText = document.querySelector('.no-posts');

  let posts = JSON.parse(localStorage.getItem('gamerPosts')) || [];

  function savePosts() {
    localStorage.setItem('gamerPosts', JSON.stringify(posts));
  }

  function renderPosts() {
    if(posts.length === 0){
      noPostsText.style.display = 'block';
    } else {
      noPostsText.style.display = 'none';
    }

    postsContainer.innerHTML = posts.length === 0 ? noPostsText.outerHTML : '';

    posts.forEach(post => {
      const postEl = document.createElement('div');
      postEl.className = 'post';

      const avatarLetter = post.username.charAt(0).toUpperCase();

      postEl.innerHTML = `
        <div class="post-header">
          <div class="avatar">${avatarLetter}</div>
          <div class="username">${post.username}</div>
        </div>
        <div class="content">${escapeHtml(post.content)}</div>
        <button class="like-btn ${post.liked ? 'liked' : ''}" data-id="${post.id}">❤️ ${post.likes}</button>
      `;

      postsContainer.appendChild(postEl);
    });

    document.querySelectorAll('.like-btn').forEach(btn => {
      btn.onclick = () => {
        const id = btn.getAttribute('data-id');
        const post = posts.find(p => p.id === id);
        if(post){
          if(post.liked){
            post.likes--;
            post.liked = false;
          } else {
            post.likes++;
            post.liked = true;
          }
          savePosts();
          renderPosts();
        }
      };
    });
  }

  function escapeHtml(text) {
    const map = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#039;',
    };
    return text.replace(/[&<>"']/g, function(m) { return map[m]; });
  }

  postForm.onsubmit = e => {
    e.preventDefault();
    const username = usernameInput.value.trim();
    const content = contentInput.value.trim();

    if(!username || !content){
      alert('Pseudo et contenu requis.');
      return;
    }

    const newPost = {
      id: Date.now().toString(),
      username,
      content,
      likes: 0,
      liked: false,
    };

    posts.unshift(newPost);
    savePosts();
    renderPosts();

    contentInput.value = '';
  };

  renderPosts();
</script>
</body>
</html>
